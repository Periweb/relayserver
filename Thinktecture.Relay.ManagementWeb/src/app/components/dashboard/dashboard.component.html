<ng-container *ngIf="info$ | async as info; else loading">
  <mat-tab-group>
    <mat-tab [label]="'Chart' | translate">
      <canvas baseChart chartType="line" [labels]="info.chartLabels" [options]="chartOptions"
              [datasets]="info.chartData"></canvas>
    </mat-tab>
    <mat-tab [label]="'Recent logs' | translate">
      <mat-table [dataSource]="info.logs">
        <ng-container matColumnDef="linkId">
          <mat-header-cell *matHeaderCellDef><span translate>Link ID</span></mat-header-cell>
          <mat-cell *matCellDef="let log" [matTooltip]="log.linkId" matTooltipPosition="right">{{ log.linkId.substr(0, 8) }}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="httpStatusCode">
          <mat-header-cell *matHeaderCellDef><span translate>Status</span></mat-header-cell>
          <mat-cell *matCellDef="let log">{{ log.httpStatusCode }}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="onPremiseTargetKey">
          <mat-header-cell *matHeaderCellDef><span translate>Target</span></mat-header-cell>
          <mat-cell *matCellDef="let log">{{ log.onPremiseTargetKey }}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="localUrl">
          <mat-header-cell *matHeaderCellDef><span translate>Local URL</span></mat-header-cell>
          <mat-cell *matCellDef="let log">{{ log.localUrl }}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="contentBytesIn">
          <mat-header-cell *matHeaderCellDef><span translate>Content bytes in</span></mat-header-cell>
          <mat-cell *matCellDef="let log">{{ log.contentBytesIn | number }}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="contentBytesOut">
          <mat-header-cell *matHeaderCellDef><span translate>Content bytes out</span></mat-header-cell>
          <mat-cell *matCellDef="let log">{{ log.contentBytesOut | number }}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="onPremiseConnectorInDate">
          <mat-header-cell *matHeaderCellDef><span translate>Connector in date</span></mat-header-cell>
          <mat-cell *matCellDef="let log">{{ log.onPremiseConnectorInDate.format('L LTS') }}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="onPremiseConnectorOutDate">
          <mat-header-cell *matHeaderCellDef><span translate>Connector out date</span></mat-header-cell>
          <mat-cell *matCellDef="let log">{{ log.onPremiseConnectorOutDate.format('L LTS') }}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="onPremiseTargetInDate">
          <mat-header-cell *matHeaderCellDef><span translate>Target in date</span></mat-header-cell>
          <mat-cell *matCellDef="let log">{{ log.onPremiseTargetInDate?.format('L LTS') }}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="onPremiseTargetOutDate">
          <mat-header-cell *matHeaderCellDef><span translate>Target out date</span></mat-header-cell>
          <mat-cell *matCellDef="let log">{{ log.onPremiseTargetOutDate?.format('L LTS') }}</mat-cell>
        </ng-container>
        <ng-container matColumnDef="originId">
          <mat-header-cell *matHeaderCellDef><span translate>Origin ID</span></mat-header-cell>
          <mat-cell *matCellDef="let log" [matTooltip]="log.originId" matTooltipPosition="left">{{ log.originId.substr(0, 8) }}</mat-cell>
        </ng-container>

        <mat-header-row *matHeaderRowDef="logColumns"></mat-header-row>
        <mat-row *matRowDef="let row; columns: logColumns;"></mat-row>
      </mat-table>
    </mat-tab>
  </mat-tab-group>
</ng-container>

<ng-template #loading>
  <trs-spinner-overlay></trs-spinner-overlay>
</ng-template>
